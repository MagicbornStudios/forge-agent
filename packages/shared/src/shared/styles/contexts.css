/* ==========================================================================
   Domain context theming (data-domain)
   Shared tokens: --context-accent, --context-glow, --context-ring
   Set per-domain from --domain-* and --graph-* in themes.css
   ========================================================================== */

/* ---- Shared ---- */
/* Keep --context-accent and --ring aligned so focus + hover stay in-domain. */
:root {
  --context-accent: var(--border-hover);
  --context-glow: color-mix(in oklab, var(--context-accent) 35%, transparent);
  --context-ring: color-mix(in oklab, var(--context-accent) 60%, transparent);
}

[data-domain] {
  --context-glow: color-mix(in oklab, var(--context-accent) 35%, transparent);
  --context-ring: color-mix(in oklab, var(--context-accent) 60%, transparent);
  --glow-focus: 0 0 0 2px var(--context-ring), 0 0 12px var(--context-glow);
  --glow-selection: 0 0 12px var(--context-glow);
  --glow-panel-accent: 0 0 0 1px var(--context-accent);
  --primary: var(--context-accent);
  --primary-foreground: var(--text-primary);
  --accent: color-mix(in oklab, var(--context-accent) 20%, var(--control-bg));
  --accent-foreground: var(--text-primary);
  --ring: var(--context-accent);
  --sidebar-primary: var(--context-accent);
  --sidebar-ring: var(--context-accent);
}

[data-domain][data-focused="false"] {
  --context-accent: var(--border-hover);
}

/* ---- Forge ---- */
[data-domain="forge"] {
  --context-accent: var(--domain-forge);
}

/* ---- Dialogue (Forge alias) ---- */
[data-domain="dialogue"] {
  --context-accent: var(--domain-dialogue);
}

[data-domain="dialogue"][data-viewport-scope="storylet"],
[data-domain="dialogue"][data-editor-scope="storylet"] {
  --context-accent: var(--graph-edge-choice-1);
}

[data-domain="dialogue"][data-context-node-type="ACT"] {
  --context-accent: var(--node-act-accent);
}

[data-domain="dialogue"][data-context-node-type="CHAPTER"] {
  --context-accent: var(--node-chapter-accent);
}

[data-domain="dialogue"][data-context-node-type="PAGE"] {
  --context-accent: var(--node-page-accent);
}

[data-domain="dialogue"][data-context-node-type="CHARACTER"] {
  --context-accent: var(--node-npc-accent);
}

[data-domain="dialogue"][data-context-node-type="PLAYER"] {
  --context-accent: var(--node-player-accent);
}

[data-domain="dialogue"][data-context-node-type="CONDITIONAL"] {
  --context-accent: var(--node-conditional-accent);
}

[data-domain="dialogue"][data-context-node-type="STORYLET"] {
  --context-accent: var(--node-storylet-accent);
}

[data-domain="dialogue"][data-context-node-type="DETOUR"] {
  --context-accent: var(--node-detour-accent);
}

[data-domain="dialogue"][data-context-node-type="JUMP"] {
  --context-accent: var(--status-warning);
}

[data-domain="dialogue"][data-context-node-type="END"] {
  --context-accent: var(--text-tertiary);
}

[data-domain="forge"][data-viewport-scope="storylet"],
[data-domain="forge"][data-editor-scope="storylet"] {
  --context-accent: var(--graph-edge-choice-1);
}

[data-domain="forge"][data-context-node-type="ACT"] {
  --context-accent: var(--node-act-accent);
}

[data-domain="forge"][data-context-node-type="CHAPTER"] {
  --context-accent: var(--node-chapter-accent);
}

[data-domain="forge"][data-context-node-type="PAGE"] {
  --context-accent: var(--node-page-accent);
}

[data-domain="forge"][data-context-node-type="CHARACTER"] {
  --context-accent: var(--node-npc-accent);
}

[data-domain="forge"][data-context-node-type="PLAYER"] {
  --context-accent: var(--node-player-accent);
}

[data-domain="forge"][data-context-node-type="CONDITIONAL"] {
  --context-accent: var(--node-conditional-accent);
}

[data-domain="forge"][data-context-node-type="STORYLET"] {
  --context-accent: var(--node-storylet-accent);
}

[data-domain="forge"][data-context-node-type="DETOUR"] {
  --context-accent: var(--node-detour-accent);
}

[data-domain="forge"][data-context-node-type="JUMP"] {
  --context-accent: var(--status-warning);
}

[data-domain="forge"][data-context-node-type="END"] {
  --context-accent: var(--text-tertiary);
}

/* ---- Writer ---- */
[data-domain="writer"] {
  --context-accent: var(--domain-writer);
}

[data-domain="writer"][data-context-node-type="PAGE"] {
  --context-accent: var(--node-page-accent);
}

/* ---- AI ---- */
[data-domain="ai"] {
  --context-accent: var(--domain-ai);
}

[data-domain="ai"][data-context-node-type="request"] {
  --context-accent: var(--status-info);
}

[data-domain="ai"][data-context-node-type="response"] {
  --context-accent: var(--status-success);
}

/* ---- Video ---- */
[data-domain="video"] {
  --context-accent: var(--domain-video);
  --video-accent: var(--domain-video);
  --video-accent-bg: color-mix(in oklab, var(--domain-video) 25%, var(--card));
  --video-accent-border: color-mix(in oklab, var(--domain-video) 70%, var(--control-border));
  --video-accent-hover: color-mix(in oklab, var(--domain-video) 90%, white);
  --video-accent-active: color-mix(in oklab, var(--domain-video) 95%, white);
  --video-canvas-bg: var(--graph-canvas);
  --video-canvas-grid: var(--graph-grid);
  --video-canvas-border: var(--control-border);
  --video-layer-bg: var(--card);
  --video-layer-border: var(--control-border);
  --video-layer-selected: var(--video-accent);
  --video-layer-hover: color-mix(in oklab, var(--video-accent) 40%, var(--control-bg));
  --video-layer-handle: var(--video-accent);
  --video-timeline-bg: var(--graph-canvas);
  --video-timeline-ruler: var(--control-border);
  --video-timeline-playhead: var(--video-accent);
  --video-timeline-track: var(--card);
  --video-inspector-bg: var(--card);
  --video-inspector-border: var(--control-border);
  --video-inspector-label: var(--text-secondary);
}

/* Video: panel border hovers */
[data-domain="video"] .border-r { position: relative; }
[data-domain="video"] .border-r::after {
  content: ''; position: absolute; inset-block: 0; right: -1px; width: 1px;
  background: var(--context-accent); opacity: 0; transition: opacity 200ms; pointer-events: none;
}
[data-domain="video"] .border-r:hover::after { opacity: 0.4; }

[data-domain="video"] .border-l::before {
  content: ''; position: absolute; inset-block: 0; left: -1px; width: 1px;
  background: var(--context-accent); opacity: 0; transition: opacity 200ms; pointer-events: none;
}
[data-domain="video"] .border-l:hover::before { opacity: 0.4; }

[data-domain="video"] .border-t::before {
  content: ''; position: absolute; inset-inline: 0; top: -1px; height: 1px;
  background: var(--context-accent); opacity: 0; transition: opacity 200ms; pointer-events: none;
}
[data-domain="video"] .border-t:hover::before { opacity: 0.4; }

[data-domain="video"] .border-b::after {
  content: ''; position: absolute; inset-inline: 0; bottom: -1px; height: 1px;
  background: var(--context-accent); opacity: 0; transition: opacity 200ms; pointer-events: none;
}
[data-domain="video"] .border-b:hover::after { opacity: 0.4; }

[data-domain="video"] [data-state="on"] {
  border-left-color: var(--context-accent) !important;
}

[data-domain="video"] .toolbar-button-active {
  background: var(--video-accent-bg);
  color: var(--video-accent);
  border-color: var(--video-accent-border);
}

[data-domain="video"] .toolbar-button-active:hover {
  background: color-mix(in oklab, var(--video-accent-bg) 80%, var(--video-accent));
  border-color: var(--video-accent-hover);
}

/* Video: utility classes */
.video-canvas { background: var(--video-canvas-bg); position: relative; }

.video-canvas-grid {
  background-image:
    linear-gradient(var(--video-canvas-grid) 1px, transparent 1px),
    linear-gradient(90deg, var(--video-canvas-grid) 1px, transparent 1px);
  background-size: 20px 20px;
}

.video-layer-selected {
  outline: 2px solid var(--video-layer-selected);
  outline-offset: -2px;
  box-shadow: 0 0 0 4px var(--context-glow);
}

.video-layer-hover {
  outline: 1px solid var(--video-layer-hover);
  outline-offset: -1px;
}

.video-resize-handle {
  position: absolute; width: 8px; height: 8px;
  background: var(--video-layer-handle);
  border: 1px solid var(--video-canvas-bg);
  border-radius: 2px; cursor: pointer; z-index: 10;
}

.video-resize-handle:hover {
  background: var(--video-accent-hover);
  transform: scale(1.2);
}

.video-timeline {
  background: var(--video-timeline-bg);
  border-top: 1px solid var(--control-border);
}

.video-timeline-ruler {
  background: var(--video-timeline-bg);
  border-bottom: 1px solid var(--video-timeline-ruler);
}

.video-timeline-playhead {
  background: var(--video-timeline-playhead);
  box-shadow: 0 0 8px var(--context-glow);
}

.video-timeline-track {
  background: var(--video-timeline-track);
  border: 1px solid var(--video-layer-border);
  border-radius: 2px;
}

.video-timeline-track:hover {
  border-color: var(--video-layer-hover);
}

.video-timeline-track-selected {
  border-color: var(--video-layer-selected);
  box-shadow: 0 0 0 2px var(--context-glow);
}

.video-property-inspector { background: var(--video-inspector-bg); }

.video-property-label {
  color: var(--video-inspector-label);
  font-size: 0.75rem; font-weight: 500; text-transform: uppercase; letter-spacing: 0.05em;
}

/* ---- Character ---- */
[data-domain="character"] {
  --context-accent: var(--domain-character);
}
