---
title: Forge Agent - Project overview

created: 2026-02-04
updated: 2026-02-07
---

# Forge Agent - Project overview

## Project summary

Forge Agent is an AI-first studio for editing dialogue graphs. It focuses on:

- Editor shell with multiple modes (Dialogue is primary; Character, Video, and Strategy are additional modes).
- CopilotKit for in-app AI context, actions, and suggestions.
- Payload CMS (SQLite) for local-first persistence.
- Payload-generated types used across domains for consistent schemas.

## Tech stack

- Next.js 15 (App Router, Turbopack)
- React 19
- TypeScript 5
- Tailwind CSS 4
- shadcn/ui (Radix UI)
- Zustand
- CopilotKit
- OpenRouter via OpenAI SDK + baseURL; ElevenLabs for audio; video (Sora) planned - see [06 - Model routing and OpenRouter](architecture/06-model-routing-and-openrouter.mdx)
- React Flow
- Payload CMS (SQLite)

---

## Architecture (high level)

- **App Shell** (`apps/studio/components/AppShell.tsx`, `apps/studio/lib/app-shell/store.ts`): owns mode tabs and the active mode. Only the active mode is rendered.
- **Modes**: Dialogue is primary. Character and Video are editors; Strategy is the assistant-ui strategy editor.
- **Shared**: `packages/shared/src/shared` contains the editor UI kit, headless contracts, assistant-ui/tool-ui components, and styling tokens.
- **Agent engine**: `packages/agent-engine` provides the workflow runtime (steps + events + SSE helpers).
- **Dev kit**: `packages/dev-kit` re-exports `@forge/ui`, `@forge/shared`, and `@forge/agent-engine` for consumers.
- **Domains**: Dialogue logic lives in `packages/domain-forge` and consumes types from `packages/types`.
- **Types**: Payload generates types into `packages/types/src/payload-types.ts`. Domain aliases live in `packages/types/src/payload.ts` and `packages/types/src/graph.ts`.
- **Persistence**: Payload runs inside the Studio app. Collections live under `apps/studio/payload/collections`.
- **Settings**: Config-based defaults in `apps/studio/lib/settings/config.ts`. Overrides are loaded from Payload (`settings-overrides`) on app init via `GET /api/settings` and `hydrateFromOverrides`; saved explicitly via the settings sheet Save button and `POST /api/settings`.

Note: API routes exist inside the Studio app for CopilotKit, assistant-chat, and Payload operations, but they are internal to the app and not treated as separate services.

---

## Codebase layout (what each folder does)

| Path | Purpose |
|------|---------|
| **apps/studio/app/** | Next.js App Router: layout, page, globals.css, internal API routes. |
| **apps/studio/components/** | Studio UI (AppShell, modes, settings, providers, shadcn UI). |
| **apps/studio/payload/** | Payload config and collections for Studio. |
| **apps/studio/lib/** | App logic (stores, model router, settings, graph operations, utils). |
| **packages/shared/** | Shared editor UI kit and headless contracts. |
| **packages/agent-engine/** | Workflow runtime (steps + events + SSE). |
| **packages/dev-kit/** | Meta-package that re-exports forge foundation packages for consumers. |
| **packages/domain-forge/** | Dialogue domain logic (types, store, operations, copilot wiring). |
| **packages/ui/** | Shared shadcn UI atoms (Radix-based primitives). |
| **packages/types/** | Payload-generated types + domain aliases (source of truth). |
| **docs/** | Documentation (STATUS, architecture, design, guides). How-to guides live in `docs/how-to/` (numbered 00-09, 21-22) and are also served in-app at `/docs`. |
| **__tests__/** | Jest tests. |
| **__mocks__/** | Jest mocks (server-only, etc.). |

---

## File tree (current)

```
AGENTS.md
README.md
SETUP.md
pnpm-workspace.yaml
package.json

apps/
  studio/
    app/
      layout.tsx
      page.tsx
      api/
        assistant-chat/route.ts
        copilotkit/route.ts
        graphs/route.ts
        graphs/[id]/route.ts
        model-settings/route.ts
        settings/route.ts
    components/
      AppShell.tsx
      GraphEditor.tsx
      CreateNodeModal.tsx
      copilot/
      forge/
      media/
      modes/
      providers/
      settings/
      video/
      workspaces/
        legacy/
    lib/
      app-shell/
      domains/
        video/
      model-router/
      settings/
    payload/
      collections/
        projects.ts
        users.ts
        agent-sessions.ts
        forge-graphs.ts
        settings-overrides.ts
        video-docs.ts
      collections/index.ts
    payload.config.ts
    next.config.ts
    postcss.config.mjs
    tsconfig.json
    components.json

packages/
  shared/
    src/
      index.ts
      shared/
        components/
          app/
          assistant-ui/
          editor/
          tool-ui/
          workspace/
        copilot/
        styles/
        workspace/
        AGENTS.md
    package.json
  domain-forge/
    src/
      copilot/
      operations.ts
      scene.ts
      store.ts
      types.ts
      index.ts
    package.json
  ui/
    src/
      components/
        ui/
      lib/
      index.ts
    package.json
  types/
    src/
      graph.ts
      payload.ts
      payload-types.ts
      index.ts
    package.json

examples/
  consumer/
    app/
      api/
        assistant-chat/route.ts
      page.tsx

docs/
  agent-artifacts/core/
  10-project-overview.mdx
  architecture/
  design/
  how-to/

scripts/
  generate-payload-types.mjs

__tests__/
__mocks__/

types/
  README.md
```

---

## Key configuration files

| File | Purpose |
|------|---------|
| **package.json** | Workspace root scripts (pnpm filters for Studio). |
| **apps/studio/package.json** | Studio app deps and scripts. |
| **apps/studio/tsconfig.json** | Studio TS config and path aliases. |
| **apps/studio/next.config.ts** | Next config + transpile workspace packages. |
| **apps/studio/payload.config.ts** | Payload config; generates types into `packages/types`. |
| **packages/types/src/payload-types.ts** | Generated Payload types (do not edit). |
| **packages/types/src/payload.ts** | Domain aliases for payload-generated types. |
| **apps/studio/components.json** | shadcn/ui config. |
| **jest.config.js** | Jest config with moduleNameMapper for workspace aliases. |

---

## Entry and data flow

- **Entry**: `apps/studio/app/layout.tsx` -> `apps/studio/app/page.tsx`.
- **AppShell**: Reads app-shell store and renders the active mode. Mode tabs use shared components from `@forge/shared`.
- **Dialogue mode**: Composes `EditorShell` and `DockLayout` from `@forge/shared` with the GraphEditor as the main surface.
- **CopilotKit**: The active mode registers context + actions from domain wiring; the chat uses those to propose edits.
- **Payload**: Collections define persisted shapes; generated types are used by domain logic for type safety.

---

## How-to guides

Numbered guides in `docs/how-to/` build an editor mode from the ground up. They are served in the Studio app at **/docs** (sidebar + article). Order: 01 Foundation -> 02 Editor shell and slots -> 03 Styling -> 04 Data and state -> 05 Building an editor mode -> 06 DialogueMode walkthrough -> 07 Copilot and AI integration -> 08 Adding AI to modes -> 09 VideoMode walkthrough -> 21 Workspace -> Editor migration -> 22 AI generation components. Each guide includes "What the AI can do at this stage" and points to real code.

---

## References

- **AGENTS.md** (root): Agent rules and boundaries.
- **docs/agent-artifacts/core/STATUS.md**: Current state and Ralph Wiggum loop.
- **docs/how-to/00-index.mdx**: Index of how-tos and reference doc links.
- **packages/shared/src/shared/AGENTS.md** and **packages/shared/src/shared/components/workspace/AGENTS.md**: Shared UI rules.
