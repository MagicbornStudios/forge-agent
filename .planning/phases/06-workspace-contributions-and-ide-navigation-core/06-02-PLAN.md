---
phase: 06-workspace-contributions-and-ide-navigation-core
plan: 02
wave: 2
depends_on:
  - '06-01'
files_modified:
  - apps/repo-studio/src/components/features/code/*
  - apps/repo-studio/src/components/features/commands/*
  - apps/repo-studio/src/components/features/code/*
  - apps/repo-studio/src/components/features/git/*
  - apps/repo-studio/src/lib/app-shell/store.ts
  - apps/repo-studio/src/lib/app-shell/editor-panels.ts
  - apps/repo-studio/src/lib/api/services/*
autonomous: true
must_haves:
  truths:
    - "Navigator must be generic and reusable across workspaces, with Code workspace as first rollout consumer (IN-01)."
    - "Feature workspaces must consume typed service layer instead of direct fetch."
  artifacts:
    - path: ".planning/phases/06-workspace-contributions-and-ide-navigation-core/06-02-SUMMARY.md"
      provides: "Navigator panel delivery and workspace fetch-to-service migration summary."
      min_lines: 16
  key_links:
    - from: ".planning/ANALYSIS-REFERENCES.md"
      to: "ide_navigation_analysis/DECISIONS.md"
      via: "IN-01 generic navigator baseline"
---

<objective>
Deliver Navigator panel foundation, panel wiring, and feature workspace service refactors for Code-first IDE navigation behavior.
</objective>

<context>
@.planning/ANALYSIS-REFERENCES.md
@ide_navigation_analysis/DECISIONS.md
@repo_studio_analysis/DECISIONS-WORKSPACE-PANELS.md
</context>

<tasks>
<task type="auto">
  <name>Add Navigator panel model and shared selection state</name>
  <files>apps/repo-studio/src/components/features/code/*; apps/repo-studio/src/lib/app-shell/store.ts; apps/repo-studio/src/lib/app-shell/editor-panels.ts</files>
  <action>Introduce navigator panel with tree + selection plumbing and dock visibility registration.</action>
  <verify>Selecting file in navigator updates Code workspace editor target path deterministically.</verify>
  <done>Navigator is visible as reusable panel and integrated in shell layout.</done>
</task>

<task type="auto">
  <name>Refactor feature workspaces to service clients</name>
  <files>apps/repo-studio/src/components/features/story/StoryWorkspace.tsx; apps/repo-studio/src/components/features/git/GitWorkspace.tsx; apps/repo-studio/src/components/features/code/CodeWorkspace.tsx; apps/repo-studio/src/components/features/diff/DiffWorkspace.tsx; apps/repo-studio/src/components/features/review-queue/ReviewQueueWorkspace.tsx; apps/repo-studio/src/components/features/env/EnvWorkspace.tsx</files>
  <action>Replace direct fetch calls with typed services while preserving existing UX and action flows.</action>
  <verify>No direct fetch usage remains in refactored workspace files.</verify>
  <done>Workspace networking is routed through shared API service layer.</done>
</task>

<task type="auto">
  <name>Update loop artifacts and traceability</name>
  <files>.planning/STATE.md; .planning/TASK-REGISTRY.md; .planning/DECISIONS.md; .planning/ERRORS.md</files>
  <action>Capture navigator rollout decisions, migration outcomes, and known follow-up gaps.</action>
  <verify>forge-loop progress --json advances to 06-03 after this plan is complete.</verify>
  <done>Phase artifacts match implementation state for 06-02.</done>
</task>
</tasks>
