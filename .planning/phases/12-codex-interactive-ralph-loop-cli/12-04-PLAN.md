---
phase: 12-codex-interactive-ralph-loop-cli
plan: 04
wave: 4
depends_on:
  - 12-01
  - 12-02
  - 12-03
files_modified:
  - packages/forge-loop/src/commands/discuss-phase.mjs
  - packages/forge-loop/src/commands/plan-phase.mjs
  - packages/forge-loop/src/commands/execute-phase.mjs
  - packages/forge-loop/src/commands/doctor.mjs
  - packages/forge-loop/src/cli.mjs
autonomous: true
must_haves:
  truths:
    - "Runner selection is available on discuss/plan/execute commands."
    - "Prompt-pack behavior remains stable when no runner is selected."
    - "Doctor reports runner readiness diagnostics with deterministic fallback semantics."
  artifacts:
    - path: ".planning/phases/12-codex-interactive-ralph-loop-cli/12-04-SUMMARY.md"
      provides: "Stage command integration and compatibility summary."
      min_lines: 10
  key_links:
    - from: ".planning/TASK-REGISTRY.md"
      to: ".planning/phases/12-codex-interactive-ralph-loop-cli/12-04-SUMMARY.md"
      via: "runner wiring + backward compatibility trace"
---

<objective>
Wire stage commands to runtime resolver and codex task-result semantics while preserving existing prompt-pack/manual flows.
</objective>

<context>
@packages/forge-loop/src/commands/discuss-phase.mjs
@packages/forge-loop/src/commands/plan-phase.mjs
@packages/forge-loop/src/commands/execute-phase.mjs
@packages/forge-loop/src/commands/doctor.mjs
</context>

<tasks>
<task type="auto">
  <name>Integrate runtime resolver into stage commands</name>
  <files>packages/forge-loop/src/commands/discuss-phase.mjs, packages/forge-loop/src/commands/plan-phase.mjs, packages/forge-loop/src/commands/execute-phase.mjs</files>
  <action>Add runner option handling and provider-based execution branches for discuss/plan/execute.</action>
  <verify>`--runner prompt-pack` and default mode preserve previous outputs and behavior.</verify>
  <done>Stage commands emit extended machine-readable result fields without regressions.</done>
</task>

<task type="auto">
  <name>Extend doctor runtime diagnostics</name>
  <files>packages/forge-loop/src/commands/doctor.mjs, packages/forge-loop/src/lib/runtime/resolver.mjs, packages/forge-loop/src/lib/codex/cli-status.mjs</files>
  <action>Emit runtime runner readiness fields and fallback reasons in both text and JSON doctor outputs.</action>
  <verify>`forge-loop doctor --json` reports codex readiness fields and returns failure only under deterministic runtime failure semantics.</verify>
  <done>Runtime diagnostics support codex/prompt-pack/auto operation contracts.</done>
</task>
</tasks>
