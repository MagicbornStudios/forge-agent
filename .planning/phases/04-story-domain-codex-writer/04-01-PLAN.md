---
phase: 04-story-domain-codex-writer
plan: 01
wave: 1
depends_on: []
files_modified:
  - apps/repo-studio/src/components/features/story/StoryWorkspace.tsx
  - apps/repo-studio/src/lib/story-domain.ts
  - apps/repo-studio/src/lib/repo-studio-config.ts
  - .repo-studio/config.json
autonomous: true
must_haves:
  truths:
    - "Story domain must parse mixed legacy and canonical naming without forced renames."
    - "Canonical create writes must always target content/story/act-XX/chapter-XX/page-XXX.md."
  artifacts:
    - path: ".planning/phases/04-story-domain-codex-writer/04-01-SUMMARY.md"
      provides: "Story domain parser + canonical write execution summary."
      min_lines: 10
  key_links:
    - from: ".planning/ROADMAP.md"
      to: ".planning/phases/04-story-domain-codex-writer/04-01-SUMMARY.md"
      via: "phase-to-summary traceability"
---

<objective>
Stabilize Story domain model contracts and canonical creation behavior for scoped authoring workflows.
</objective>

<context>
@apps/repo-studio/src/components/features/story
@apps/repo-studio/src/lib/story-domain.ts
@.repo-studio/config.json
</context>

<tasks>
<task type="auto">
  <name>Finish story parser contracts</name>
  <files>apps/repo-studio/src/lib/story-domain.ts</files>
  <action>Validate ordering metadata and dual naming parse behavior for act/chapter/page nodes.</action>
  <verify>Mixed naming trees render in stable order and canonical create remains deterministic.</verify>
  <done>Story tree is stable for both legacy and canonical folder conventions.</done>
</task>

<task type="auto">
  <name>Story editor UX hardening</name>
  <files>apps/repo-studio/src/components/features/story/StoryWorkspace.tsx</files>
  <action>Finalize create/save/read flows, scope token affordances, and assistant attach actions for story pages.</action>
  <verify>Users can create, edit, and read story pages without raw API payloads.</verify>
  <done>Story workspace is usable as a focused writer editor surface.</done>
</task>
</tasks>
