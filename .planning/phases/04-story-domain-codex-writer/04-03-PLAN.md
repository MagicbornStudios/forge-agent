---
phase: 04-story-domain-codex-writer
plan: 03
wave: 3
depends_on:
  - '04-01'
  - '04-02'
files_modified:
  - apps/repo-studio/src/components/RepoStudioShell.tsx
  - apps/repo-studio/src/components/features/story/StoryWorkspace.tsx
  - apps/repo-studio/src/components/features/git/GitWorkspace.tsx
  - apps/repo-studio/src/components/features/diff/DiffWorkspace.tsx
  - apps/repo-studio/src/lib/diff-service.ts
  - apps/repo-studio/src/lib/app-shell/editor-panels.ts
  - apps/repo-studio/src/lib/app-shell/store.ts
autonomous: true
must_haves:
  truths:
    - "Story, Git, Diff, and Assistant surfaces must be docked editor panels with persistent layout behavior."
    - "Diff workflows must be reusable across story and planning scopes."
  artifacts:
    - path: ".planning/phases/04-story-domain-codex-writer/04-03-SUMMARY.md"
      provides: "Story workspace + diff/git panel parity execution summary."
      min_lines: 10
  key_links:
    - from: ".planning/ROADMAP.md"
      to: ".planning/phases/04-story-domain-codex-writer/04-03-SUMMARY.md"
      via: "phase-to-summary traceability"
---

<objective>
Deliver Studio-grade Story authoring workflows with reusable diff and Git control panels in RepoStudio.
</objective>

<context>
@apps/repo-studio/src/components/RepoStudioShell.tsx
@apps/repo-studio/src/components/features/story
@apps/repo-studio/src/components/features/git
@apps/repo-studio/src/components/features/diff
</context>

<tasks>
<task type="auto">
  <name>Promote story and git to first-class dock panels</name>
  <files>apps/repo-studio/src/components/RepoStudioShell.tsx, apps/repo-studio/src/lib/app-shell/*</files>
  <action>Wire story/git panels, visibility settings, and persistent layout state into the shared panel model.</action>
  <verify>Panels can be shown/hidden/restored from View menu and sidebar settings controls.</verify>
  <done>Story and Git operations are first-class in the Studio shell.</done>
</task>

<task type="auto">
  <name>Unify diff workflows for story and planning</name>
  <files>apps/repo-studio/src/lib/diff-service.ts, apps/repo-studio/src/components/features/diff/DiffWorkspace.tsx</files>
  <action>Add scope presets and assistant attach flow reuse for story/planning review workflows.</action>
  <verify>Diff panel supports story scope and can attach structured diff context to assistants.</verify>
  <done>Diff behavior is reusable across domain-focused workflows.</done>
</task>
</tasks>
