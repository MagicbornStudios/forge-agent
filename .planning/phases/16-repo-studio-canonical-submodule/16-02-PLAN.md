# Plan 16-02: Switch to canonical build from submodule

## Goal

After 16-01 verification, make the **submodule** the single source for the Repo Studio app and desktop package: the monorepo builds the Electron app from `vendor/repo-studio` (or its inner structure), not from in-repo `apps/repo-studio` and `packages/repo-studio`. Optionally remove or archive the in-repo copies once the switch is stable.

## Prerequisites

- 16-01 complete: submodule added, verified on GitHub, pullable, and monorepo builds with submodule present.

## Scope

- **Workspace integration:** Add `vendor/repo-studio` (or the correct inner paths) to [pnpm-workspace.yaml](pnpm-workspace.yaml) so the submodule participates in the workspace, **or** ensure the submodule has a structure the existing filters can use (e.g. app and desktop package under vendor/repo-studio).
- **Build and next-server resolution:** Update [packages/repo-studio/src/desktop/next-server.mjs](packages/repo-studio/src/desktop/next-server.mjs) and [packages/repo-studio/src/desktop/build.mjs](packages/repo-studio/src/desktop/build.mjs) to resolve the app root from the submodule (e.g. `vendor/repo-studio` or config/env), so the standalone Next build and desktop package use the submodule tree.
- **Release workflow:** Ensure the release workflow (verify + package_windows) builds from the submodule (e.g. filter or path points at submodule app/desktop).
- **In-repo app/package:** Remove or archive `apps/repo-studio` and `packages/repo-studio` from forge-agent once the build-from-submodule path is stable; update any references (scripts, docs, guards).

## Out of scope

- Changing the RepoStudio repoâ€™s internal structure (that repo may be updated separately to match what the monorepo expects).
- Moving the release workflow to the RepoStudio repo (release can stay on forge-agent).

## Tasks (to be refined after 16-01 and submodule structure review)

| ID | Task | Status |
|----|------|--------|
| FRG-1610 | Integrate vendor/repo-studio into pnpm workspace (or document required submodule layout) | Pending |
| FRG-1611 | Update next-server.mjs and build.mjs to resolve app root from submodule | Pending |
| FRG-1612 | Update release workflow to run desktop build from submodule | Pending |
| FRG-1613 | Remove or archive apps/repo-studio and packages/repo-studio from forge-agent; update scripts/guards/docs | Pending |
| FRG-1614 | Verification: Full release path (verify + package_windows) produces .exe from submodule; update STATE/DECISIONS | Pending |

## Done criteria

- Desktop app is built from the submodule only.
- Release workflow produces GitHub Release assets from submodule build.
- In-repo Repo Studio app/package removed or archived; monorepo is shared packages + platform + Repo Studio (submodule).
