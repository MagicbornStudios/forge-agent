# Plan 18-03: Capability payload extension and Repo Studio usage

## Goal

Extend the existing platform auth response with gateway capability flags (e.g. `openRouterProxy`, `extensionInstallProxy`). Repo Studio checks these capabilities before using platform proxy vs local/direct paths.

## Scope

- **Platform:** Include in auth/validation response (e.g. connection validate or status endpoint) a `capabilities` object that includes:
  - `openRouterProxy: boolean` — true when platform has Open Router proxy configured (e.g. OPENROUTER_API_KEY set).
  - `extensionInstallProxy: boolean` — true when platform can fetch extensions (e.g. GitHub token for RepoStudio-Extensions set).
- **Repo Studio:** Types in [apps/repo-studio/src/lib/api/types.ts](../../../apps/repo-studio/src/lib/api/types.ts) extend `RepoAuthStatusResponse.capabilities` with these flags (backward-compatible: optional or default false).
- **Repo Studio:** Assistant and extension-install flows read capabilities and choose platform proxy vs local accordingly (implemented in 18-01 and 18-02; this plan covers schema and wiring).

## Out of scope

- New auth flows; existing connect/validate/status remain.
- Capabilities for future integrations (add when needed).

## Tasks

| ID | Task | Status |
|----|------|--------|
| FRG-1807 | Platform: add openRouterProxy and extensionInstallProxy to auth/status response capabilities (derive from env presence) | Pending |
| FRG-1808 | Repo Studio: extend RepoAuthStatusResponse.capabilities type; read flags and wire to 18-01/18-02 client behavior; docs/decisions | Pending |

## Done criteria

- Auth response includes capability flags; platform sets them from env.
- Repo Studio types and client use capabilities for proxy vs local choice.
- DECISIONS entry for platform-as-gateway and HUMAN-TASKS reference.
