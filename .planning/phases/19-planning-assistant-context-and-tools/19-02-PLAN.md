# Plan 19-02: Plan-specific Forge tools

## Goal

Add **plan-specific tools** for the Forge assistant so it can act on the plan, not only read it via text context. All tools are scoped to the **active loop's planning root** (from request context: loopId → `.planning` or `.planning/loops/<loopId>`).

## Scope

- **add_task** — Add a task (e.g. to TASK-REGISTRY or a phase plan file). Inputs: task description or structured fields; optional phase/plan id. Server resolves planning root from loopId and writes.
- **update_task_status** — Mark task complete/in progress (parse TASK-REGISTRY or phase file, update row, write back). Same loop scoping.
- **open_planning_doc** — Return doc id/path so the client can open or focus that doc (event or instruction); no file write required.
- Wire tools to the Forge runtime contract used in Repo Studio ([createRepoForgeRuntimeContract](../../../apps/repo-studio/src/lib/assistant/forge-contract.ts)); tools receive loopId (and optional selectedDocId) from request context.
- Document in DECISIONS.

## Out of scope

- LangGraph (19-03). Tools are invoked by the existing stream path.
- Changing TASK-REGISTRY or phase file format; only additive parsing/writing.

## Tasks

| ID | Task | Status |
|----|------|--------|
| FRG-1903 | Implement add_task tool: resolve planning root from loopId, append/insert task, write back | Pending |
| FRG-1904 | Implement update_task_status tool: parse task table, update status, write back | Pending |
| FRG-1905 | Implement open_planning_doc tool: return doc id/path; client handles open/focus (event or instruction) | Pending |
| FRG-1905b | Wire plan tools to Forge contract and assistant-chat route; document in DECISIONS | Pending |

## Done criteria

- Forge assistant can add tasks, update task status, and request open planning doc; all scoped to active loop.
- DECISIONS entry for plan tools and loop scoping.
