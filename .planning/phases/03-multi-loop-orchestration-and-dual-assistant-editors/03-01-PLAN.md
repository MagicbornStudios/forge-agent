---
phase: 03-multi-loop-orchestration-and-dual-assistant-editors
plan: 01
wave: 1
depends_on: []
files_modified:
  - packages/forge-loop/src/cli.mjs
  - packages/forge-loop/src/lib/loops.mjs
  - apps/repo-studio/src/lib/repo-data.ts
  - apps/repo-studio/app/api/repo/loops/list/route.ts
  - apps/repo-studio/app/api/repo/loops/use/route.ts
  - apps/repo-studio/app/api/repo/loops/snapshot/route.ts
autonomous: true
must_haves:
  truths:
    - "Forge Loop supports explicit loop creation/selection without breaking default `.planning` workflows."
    - "RepoStudio can switch loops and refresh planning state deterministically."
  artifacts:
    - path: ".planning/phases/03-multi-loop-orchestration-and-dual-assistant-editors/03-01-SUMMARY.md"
      provides: "Execution summary for multi-loop core + loop switch APIs."
      min_lines: 12
  key_links:
    - from: ".planning/ROADMAP.md"
      to: ".planning/phases/03-multi-loop-orchestration-and-dual-assistant-editors/03-01-SUMMARY.md"
      via: "phase-to-summary traceability"
---

<objective>
Implement the multi-loop control-plane baseline (`LOOPS.json`, loop commands, and loop-scoped snapshots in RepoStudio).
</objective>

<context>
@packages/forge-loop/src
@apps/repo-studio/src/lib
@apps/repo-studio/app/api/repo/loops
</context>

<tasks>
<task type="auto">
  <name>Add loop index and loop command surface</name>
  <files>packages/forge-loop/src/cli.mjs, packages/forge-loop/src/lib/loops.mjs, packages/forge-loop/src/commands/loop-*.mjs</files>
  <action>Implement `loop:list`, `loop:new`, `loop:use` and loop-aware lifecycle command routing via `--loop`.</action>
  <verify>`forge-loop -- loop:list --json` and `forge-loop progress --loop &lt;id&gt; --json` return expected loop metadata.</verify>
  <done>Multi-loop selection is available from CLI with default-loop backward compatibility.</done>
</task>

<task type="auto">
  <name>Add RepoStudio loop APIs and loop switch wiring</name>
  <files>apps/repo-studio/src/lib/repo-data.ts, apps/repo-studio/app/api/repo/loops/*</files>
  <action>Expose loop list/use/snapshot routes and return loop-scoped planning snapshots.</action>
  <verify>Switching loops updates planning snapshot and active loop metadata in RepoStudio.</verify>
  <done>Planning workspace can change loops without requiring manual app reload.</done>
</task>
</tasks>

