---
phase: 02-repostudio-command-center
plan: 01
wave: 1
depends_on: []
files_modified: []
autonomous: true
must_haves:
  truths:
    - "Forge env internals are modularized for extension without command regressions."
    - "Workspace discovery is first-class and reported through doctor/diff outputs."
  artifacts:
    - path: ".planning/phases/02-repostudio-command-center/02-01-SUMMARY.md"
      provides: "Execution summary for env refactor and discovery contracts."
      min_lines: 12
  key_links:
    - from: ".planning/ROADMAP.md"
      to: ".planning/phases/02-repostudio-command-center/02-01-SUMMARY.md"
      via: "phase-to-summary traceability"
---

<objective>
Reset planning state for RepoStudio work and complete `forge-env` core modularization + discovery contracts.
</objective>

<context>
@.planning/PROJECT.md
@.planning/REQUIREMENTS.md
@.planning/ROADMAP.md
@.planning/STATE.md
@packages/forge-env/src
</context>

<tasks>
<task type="auto">
  <name>Normalize planning artifacts for phase 02</name>
  <files>.planning/ROADMAP.md, .planning/STATE.md, .planning/REQUIREMENTS.md, .planning/TASK-REGISTRY.md</files>
  <action>Create coherent Phase 02 roadmap/state/registry entries while preserving Phase 01 history.</action>
  <verify>`forge-loop progress` routes to phase 02 and reports next action correctly.</verify>
  <done>Planning artifacts are coherent and phase routing is stable.</done>
</task>

<task type="auto">
  <name>Split forge-env engine into focused modules</name>
  <files>packages/forge-env/src/lib/*</files>
  <action>Extract discovery/sources/merge/readiness/writers/reporting modules and keep engine.mjs as compatibility facade.</action>
  <verify>forge-env command outputs remain behaviorally compatible.</verify>
  <done>Core internals are modular and testable.</done>
</task>

<task type="auto">
  <name>Add workspace discovery and mismatch reporting</name>
  <files>packages/forge-env/src/lib/*, packages/forge-env/src/commands/*</files>
  <action>Scan workspace targets, merge with manifest targets, and expose mismatch metadata in doctor/diff JSON outputs.</action>
  <verify>doctor/diff surface discovered targets and drift warnings deterministically.</verify>
  <done>Discovery contract is implemented without destructive mutations.</done>
</task>
</tasks>
